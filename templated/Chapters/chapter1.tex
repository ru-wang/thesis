\chapter{绪论}\label{ch:intro}

随着人工智能概念的兴起和增强现实（Augmented Reality，简称AR）、无人机、移动机器人、自动驾驶等行业的发展，工业界与学术界对高效率、高精度的鲁棒三维感知算法的需求越来越大。这类应用通常需要实时并持续地获取场景空间的三维结构信息以及自身的位姿（朝向和位置）和运动信息。传统的三维感知方案受限于自身的局限性，很难同时满足精度、效率和鲁棒性的需求。如普通的GPS定位由于频率和精度较低且无法在室内或恶劣天气中使用；高精度GNSS系统（Global Navigation Satellite System）和惯性导航系统INS（Inertial Navigation System）虽然在精度、效率和鲁棒性上都能达到要求，但由于售价高达数千至数十万美元，通常只能在高端领域中使用；廉价的消费级别惯性测量单元（Inertial Measurement Unit，简称IMU）能以非常高的频率实时获取自身的运动信息且具备非常高的稳定性，但由于其传感器噪声过大，误差累积严重，通常只能用来测量旋转信息或初步地测量平移信息。

同时定位和建图（Simultaneous Localization and Mapping，简称SLAM）算法指在未知环境中，让搭载传感器的设备从某一位置出发对场景进行观测，在运动和观测过程中计算出自身的位姿（朝向和位置），同时逐渐构建场景地图的过程，其中传感器通常指消费级的相机设备，也可能包括但激光雷达、IMU等其他传感器。目前在计算机视觉领域，基于多视图几何和运动恢复结构（Structure from Motion，简称SfM）的算法\citep{hartley2003multiple,ma2012invitation}已经能做到非常精确的场景地图重建和传感器的定位，却由于其只能离线工作而不能满足实时性要求高的应用。视觉SLAM（Visual SLAM，简称VSLAM）可以被认为是在线版本的SfM，是使用相机（单目相机或多目相机）作为唯一的传感器，利用视觉信息进行定位和定位和建图的方法。相对于SfM，VSLAM利用了连续图像帧的局部性，逐步、增量地计算出位姿并恢复场景的三维结构，因此能比较容易地达到较高的精度和实时的效率。然而，单目VSLAM系统存在一定的局限性，即不能恢复场景的绝对尺度信息。另外，VSLAM非常依赖相机的成像质量，在图像质量不佳的时候则较难保证算法的鲁棒性。以V-LOAM\citep{zhang2015visual}为代表方法一类激光SLAM系统使用了昂贵的激光雷达传感器。由于激光雷达能够获取高精度的三维点云，使用激光雷达的SLAM系统能够获取非常高精度的建图和定位结果，同时能获得场景的绝对尺度。但是受限于成本、功耗和体积，激光雷达难以使用在移动AR、无人机或中小型移动机器人等应用上。视觉惯性SLAM（Visual Inertial SLAM，简称VISLAM）则是使用了相机和IMU作为传感器，基于IMU提供的角速度测量和加速度测量，VISLAM原生就具备了估计绝对尺度的能力。同时，受益于IMU传感器的高效和稳定，通过融合视觉信息和惯性信息，VISLAM比VSLAM具有更好的鲁棒性。

此外，VISLAM所需的相机和消费级IMU的价格低廉，容易获取，目前大部分手机都配备可以供SLAM算法使用的相机和IMU。综合成本、体积、功耗和性能，VISLAM与传统的三维感知方案或其他类型的SLAM方案相比，更适合于移动终端的AR、小型移动机器人、无人机等应用场景，是未来移动的智能设备上不可或缺的一项关键技术。

在SLAM应用中，状态估计方法的效率和精度极大地制约了SLAM算法的性能表现。目前主流的SLAM系统一般使用集束调整来进行非线性状态估计。一些系统使用了开源的通用非线性最小二乘求解器，如Ceres-Solver\citep{ceres-solver}、g$^2$o\citep{kummerle2011g}等。为了适应不同类型的优化问题，这一类求解器通常采用批量式最小二乘算法，牺牲了效率，因而难以在移动设备上达到实时的性能；一些系统使用了增量式的集束调整算法以提升效率，比如SLAM++\citep{ila2017fast}，这一类求解器由于解法固定，通常只适用于特定类型的非线性目标函数和参数化方法，或者与系统的耦合程度较高，通用性不佳。

本文基于以上分析，提出了面向VISLAM的增量式通用集束调整框架，一方面使用了增量式集束调整算法以提升算法的效率：
\begin{itemize}
    \item 在线性化和消元部分，本文使用了基于因子图的增量式方法构建舒尔补。这一方法可以显著减少冗余的计算量，提升舒尔补方程的构建效率。同时，利用因子图还被用来编码舒尔补的构建过程，并在这一过程中生成对应的贝叶斯推断树；
    \item 现有的增量式集束调整算法认为莱文贝格-马夸特（Levenberg-Marquardt，简称LM）方法中的阻尼因子会修改正规矩阵，从而破坏舒尔补构建的增量特性，故一般会使用高斯-牛顿（Gauss-Newton，简称GN）法或Dog-Leg（简称DL）法，如ICE-BA\citep{liu2018ice}和SLAM++。本文针对这一类使用增量式舒尔补的算法中常见的舒尔补矩阵秩亏的问题，提出了混合式LM-DL（Hybrid Levenberg-Marquardt-Dog-Leg，简称HLMDL）方法。这一方法可以在不破坏舒尔补构建的增量特性的前提下增强线性解的数值稳定性；
    \item 在变量回代求解部分，本文基于舒尔补构建过程中生成的贝叶斯推断树，提出了使用部分贝叶斯推断树（Partial Bayes Tree，简称PBT）的方法编码三维点状态和相机状态之间的的推断关系，以达到增量式回代求解的目的，进一步提高效率和变量一致性。
\end{itemize}

另一方面，该框架在保证一定效率和精度的基础上保持了很好的通用性：
\begin{itemize}
    \item 该框架实现了VISLAM中常用的IMU预积分\citep{forster2017manifold}目标函数和重投影误差目标函数，同时支持用户自定义任意类型的目标函数；
    \item 在变量参数化部分，提供了SLAM中常用的旋转矩阵和四元数参数化方法，同时支持用户自定义任意类型的参数化方法；
    \item 在线性部分，该框架实现了块状稀疏矩阵版本和稠密版本的的Cholesky分解、QR分解和增量式预处理共轭梯度（Incremental Preconditioned Conjugate Gradient，简称I-PCG）法等多种线性求解算法。并开放了线性求解器接口，支持用户定制符合实际数值需求的线性求解算法。
\end{itemize}
因此，该框架除了能够求解VISLAM的集束调整问题，也支持求解一般的非线性最小二乘问题。

本文提出的集束调整框架完全使用了对CPU缓存更为友好的块状稀疏矩阵来实现矩阵计算和存储，并在模拟数据和真实的集束调整数据集上进行了测试，通过实验验证了求解的效率和精度。

\input{Chapters/filtering.tex}     % section : 基于滤波方法的状态估计

\input{Chapters/smoothing.tex}     % section : 基于非线性优化方法的状态估计

\input{Chapters/related_works.tex} % section : 视觉惯性SLAM相关工作

\section{本文内容及结构}

本章总结了VSLAM、VISLAM工作中关于状态估计的研究现状。对基于滤波方法和基于非线性优化方法的状态估计进行了解释。阐述了当前SLAM领域的常用的基于滤波法和基于集束调整优化的状态估计方法，列举并分析了这些SLAM系统中状态估计方法的优缺点，并简要介绍了目前最高效的增量式集束调整方法的思想。接下来本文将着重介绍一个面向VISLAM的通用集束调整框架的实现。第~\ref{ch:vislam}~章将详细介绍目前最新的基于IMU预积分约束的目标函数，阐述IMU传感器的基本模型和使用方法，以及如何将惯性辅助模块集成进传统VSLAM的集束调整框架。包括IMU预积分方法实现，IMU状态估计的方法；第~\ref{ch:ba}~章将详细介绍基于增量式舒尔补的集束调整框架，包括增量式舒尔补的基本算法，本文提出的HLMDL算法和基于贝叶斯推断树的PBT算法，并分析与其他增量式算法之间的区别；第~\ref{ch:exp}~章通过实验结果评估求解效率，进一步验证本文提出的增量式集束调整框架的效率和精度；第~\ref{ch:con}~章给出本文的结论以及后续工作的展望。
